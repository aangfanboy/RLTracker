"""
This type stub file was generated by pyright.
"""

import abc

"""Acquisition Function Base Class."""
class AcquisitionFunction(metaclass=abc.ABCMeta):
  """Base class for acquisition functions.

  Acquisition Functions are (relatively) inexpensive functions that guide
  Bayesian Optimization search. Typically, their values at points will
  correspond to how desirable it is to evaluate the function at that point.
  This desirability can come in the form of improving information about the
  black box function (exploration) or trying to find an extrema given past
  evaluations (exploitation).

  TFP acquisition functions are callable objects that may be instantiated with
  subclass-specific parameters. This design enables expensive one-time
  computation to be run in `__init__` before the acquisition function is called
  repeatedly, for example during optimization. The `AcquisitionFunction` base
  class is instantiated with a predictive distribution (typically an instance of
  `tfd.GaussianProcessRegressionModel`, `tfd.StudentTProcessRegressionModel`, or
  `tfp.experimental.distributions.MultiTaskGaussianProcessRegressionModel`),
  previously-observed function values, and an optional random seed. The
  `__call__` method evaluates the acquisition function.
  """
  def __init__(self, predictive_distribution, observations, seed=...) -> None:
    """Initializes the acquisition function.

    Args:
      predictive_distribution: `tfd.Distribution`-like, the distribution over
        observations at a set of index points.
      observations: `Float` `Tensor` of observations.
      seed: PRNG seed; see tfp.random.sanitize_seed for details.
    """
    ...
  
  @property
  def predictive_distribution(self): # -> Any:
    """The distribution over observations at a set of index points."""
    ...
  
  @property
  def observations(self):
    """Float `Tensor` of observations."""
    ...
  
  @property
  def seed(self): # -> None:
    """PRNG seed."""
    ...
  
  @property
  def is_parallel(self): # -> Literal[False]:
    """Python `bool` indicating whether the acquisition function is parallel.

    Parallel (batched) acquisition functions evaluate batches of points rather
    than single points.
    """
    ...
  
  def __call__(self, **kwargs):
    ...
  


class MCMCReducer(AcquisitionFunction):
  """Acquisition function for reducing over batch dimensions.

  `MCMCReducer` evaluates a base acquisition function and takes the mean of the
  function values over the dimensions indicated by `reduce_dims`. `MCMCReducer`
  is useful for marginalizing over an MCMC sample of GP kernel hyperparameters,
  for example.

  #### Examples

  Build and evaluate an acquisition function that computes Gaussian Process
  Expected Improvement and then marginalizes over the leftmost batch dimension.

  ```python
  import numpy as np
  import tensorflow_probability as tfp

  tfd = tfp.distributions
  tfpk = tfp.math.psd_kernels
  tfp_acq = tfp.experimental.bayesopt.acquisition

  # Sample 10 20-dimensional index points and associated observations.
  index_points = np.random.uniform(size=[10, 20])
  observations = np.random.uniform(size=[10])

  # The kernel and GP have batch shape [32], representing a sample of
  # hyperparameters that we want to marginalize over.
  kernel_amplitudes = np.random.uniform(size=[32])

  # Build a (batched) Gaussian Process regression model.
  dist = tfd.GaussianProcessRegressionModel(
      kernel=tfpk.MaternFiveHalves(amplitude=kernel_amplitudes),
      observation_index_points=index_points,
      observations=observations)

  # Define an `MCMCReducer` with GP Expected Improvement.
  mcmc_ei = tfp_acq.MCMCReducer(
      predictive_distribution=dist,
      observations=observations,
      acquisition_class=GaussianProcessExpectedImprovement,
      reduce_dims=0)

  # Evaluate the acquisition function at a new set of index points,
  # marginalizing over the hyperparameter batch.
  pred_index_points = np.random.uniform(size=[6, 20])
  acq_fn_vals = mcmc_ei(pred_index_points)  # Has shape [6].
  ```

  """
  def __init__(self, predictive_distribution, observations, seed=..., acquisition_class=..., reduce_dims=..., **acquisition_kwargs) -> None:
    """Initializes the acquisition function.

    Args:
      predictive_distribution: `tfd.Distribution`-like, the distribution over
        observations at a set of index points.
      observations: `Float` `Tensor` of observations.
      seed: PRNG seed; see tfp.random.sanitize_seed for details.
      acquisition_class: `AcquisitionFunction`-like callable.
      reduce_dims: Axis of the acquisition function value array over which to
        marginalize.
      **acquisition_kwargs: Kwargs passed to `acquisition_class`.
    """
    ...
  
  @property
  def acquisition(self):
    ...
  
  @property
  def reduce_dims(self): # -> None:
    ...
  
  @property
  def is_parallel(self):
    ...
  
  def __call__(self, **kwargs):
    ...
  


