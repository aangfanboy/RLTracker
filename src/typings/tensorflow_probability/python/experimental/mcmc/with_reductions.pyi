"""
This type stub file was generated by pyright.
"""

import collections
from tensorflow_probability.python.mcmc import kernel as kernel_base
from tensorflow_probability.python.mcmc.internal import util as mcmc_util

"""WithReductions Transition Kernel."""
__all__ = ['WithReductions']
class WithReductionsKernelResults(mcmc_util.PrettyNamedTupleMixin, collections.namedtuple('WithReductionsKernelResults', ['reduction_results', 'inner_results'])):
  """Reducer state and diagnostics for `WithReductions`."""
  __slots__ = ...


class WithReductions(kernel_base.TransitionKernel):
  """Applies `Reducer`s to stream over MCMC samples.

  `WithReductions` augments an inner MCMC kernel with
  side-computations that can read the stream of samples as they
  are generated.  This is relevant for streaming uses of MCMC,
  where materializing the entire Markov chain history is undesirable,
  e.g. due to memory limits.

  One `WithReductions` instance can attach an arbitrary collection
  of side-computations, each of which must be packaged as a
  `Reducer`.  `WithReductions` operates by generating a
  sample with its `inner_kernel`'s `one_step`, then invoking each
  `Reducer`'s `one_step` method on that sample. The updated reducer
  states are stored in the `reduction_results` field of
  `WithReductions`' kernel results.
  """
  def __init__(self, inner_kernel, reducer, adjust_kr_fn=..., name=...) -> None:
    """Instantiates this object.

    Args:
      inner_kernel: `TransitionKernel` whose `one_step` will generate
        MCMC sample(s).
      reducer: A (possibly nested) structure of `Reducer`s to be evaluated
        on the `inner_kernel`'s samples.
      adjust_kr_fn: Optional function to adjust the kernel_results structure
        of `inner_kernel` before presenting it to `reducer`.  Useful for
        drivers (like `sample_fold`) that construct their own kernel onions,
        but accept `Reducer`s as arguments.
      name: Python `str` name prefixed to Ops created by this function.
        Default value: `None` (i.e., "reduced_kernel").
    """
    ...
  
  def one_step(self, current_state, previous_kernel_results, seed=...): # -> tuple[Any, WithReductionsKernelResults]:
    """Updates all `Reducer`s with a new sample from the `inner_kernel`.

    Args:
      current_state: `Tensor` or Python `list` of `Tensor`s
        representing the current state(s) of the Markov chain(s),
      previous_kernel_results: `WithReductionsKernelResults` named tuple.
        `WithReductionsKernelResults` contain the state of
        `reduction_results` and a reference to kernel results of
        nested `TransitionKernel`s.
      seed: PRNG seed; see `tfp.random.sanitize_seed` for details.

    Returns:
      new_state: Newest MCMC state drawn from the `inner_kernel`.
      kernel_results: `WithReductionsKernelResults` representing updated
        kernel results. Reducer states are stored in the
        `reduction_results` field. The state structure is identical
        to `self.reducer`.
    """
    ...
  
  def bootstrap_results(self, init_state, inner_results=..., previous_reducer_state=...): # -> WithReductionsKernelResults:
    """Instantiates reducer states with identical structure to the `init_state`.

    Args:
      init_state: `Tensor` or Python `list` of `Tensor`s representing the
        state(s) of the Markov chain(s). For consistency across sampling
        procedures (i.e. `tfp.mcmc.sample_chain` follows similar semantics),
        the initial state does not count as a "sample". Hence, all reducer
        states will reflect empty streams.
      inner_results: Optional results tuple for the inner kernel.  Will be
        re-bootstrapped if omitted.
      previous_reducer_state: Optional results structure for the reducers.  Will
        be re-initialized if omitted.

    Returns:
      kernel_results: `WithReductionsKernelResults` representing updated
        kernel results. Reducer states are stored in the
        `reduction_results` field. The state structure is identical
        to `self.reducer`.
    """
    ...
  
  @property
  def is_calibrated(self):
    ...
  
  @property
  def parameters(self): # -> dict[str, Any | str]:
    ...
  
  @property
  def inner_kernel(self): # -> str:
    ...
  
  @property
  def reducer(self): # -> str:
    ...
  
  @property
  def adjust_kr_fn(self): # -> str:
    ...
  
  @property
  def name(self): # -> str:
    ...
  


